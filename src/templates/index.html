{% extends "layout.html" %}
{% block title %} Citation helper {% endblock %}
{% block body %}

<div class="list-wrapper">
    <h2 id="header-list">Citation helper</h2>
    <div class="top-row">
        {% if citations | count > 0 %}
        <button onclick="document.location='bibtex'">Generate BibTeX</button>
        {% else %}
        <button onclick="document.location='bibtex'" disabled="true">
            Generate BibTeX
        </button>
        {% endif %}
        <div class="left">Amount of citations: {{ citations | count }}</div>
        <div class="right">
            <button onclick="document.location='new_citation'">
                Create new citation
            </button>
        </div>
    </div>
    <form>
      <p>
        <strong>Filter by year</strong><br />
        <label for="min_year">Min:</label>
        <input type="text" name="min_year" pattern="^\d*$" size="4" value="{{ filter_dict["min_year"] }}" />
        <label for="max_year">Max:</label>
        <input type="text" name="max_year" pattern="^\d*$" size="4" value="{{ filter_dict["max_year"] }}" />
        <button type="submit">Apply</button>
        <button type="button" name="reset" onclick="document.location='/'">Reset</button>
      </p>
    </form>
    <ul>
        {% for citation in citations %}
        <li class="list-item">
            <p>
                <strong>Title:</strong>
                <span class="cit-title">{{ citation.title }}</span>
            </p>
            <p><strong>Citation key:</strong> {{ citation.citation_key }}</p>
            <p><strong>Type:</strong> {{ citation.type }}</p>

            {% if citation.author %}
            {% if " and " in citation.author %}
            <p><strong>Authors:</strong> {{ citation.author }}</p>
            {% else %}
            <p><strong>Author:</strong> {{ citation.author }}</p>
            {% endif %}
            {% endif %}

            {% if citation.publisher %}
            <p><strong>Publisher:</strong> {{ citation.publisher }}</p>
            {% endif %}

            {% if citation.journal %}
            <p><strong>Journal / Conference:</strong> {{ citation.journal }}</p>
            {% endif %}

            {% if citation.booktitle %}
            <p><strong>Book / Proceedings title:</strong> {{ citation.booktitle }}</p>
            {% endif %}

            {% if citation.chapter %}
            <p><strong>Chapter:</strong> {{ citation.chapter }}</p>
            {% endif %}

            {% if citation.pages %}
            <p><strong>Pages:</strong> {{ citation.pages }}</p>
            {% endif %}

            {% if citation.volume %}
            <p><strong>Volume:</strong> {{ citation.volume }}</p>
            {% endif %}

            {% if citation.number %}
            <p><strong>Number / Issue:</strong> {{ citation.number }}</p>
            {% endif %}

            {% if citation.year %}
            <p><strong>Year:</strong> {{ citation.year }}</p>
            {% endif %}

            {% if citation.isbn %}
            <p><strong>ISBN:</strong> {{ citation.isbn }}</p>
            {% endif %}

            {% if citation.doi %}
            <p><strong>DOI:</strong> {{ citation.doi }}</p>
            {% endif %}

            {% if citation.url %}
            <p>
                <strong>URL:</strong>
                <a href="{{ citation.url }}">{{ citation.url }}</a>
            </p>
            {% endif %}

            {% if citation.urldate %}
            <p><strong>Visited:</strong> {{ citation.urldate }}</p>
            {% endif %}

            <div class="buttons">
                <button onclick="document.location='/edit/{{ citation.id }}'">
                    Edit
                </button>
                <form action="/delete/{{ citation.id }}" method="POST" style="display:inline;">
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to delete this citation?');">
                        Delete
                    </button>
                </form>
            </div>
        </li>
        {% endfor %}
    </ul>
</div>

{% endblock %}
